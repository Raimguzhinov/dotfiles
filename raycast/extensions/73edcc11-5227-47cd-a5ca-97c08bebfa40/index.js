"use strict";var et=Object.defineProperty;var Wt=Object.getOwnPropertyDescriptor;var Kt=Object.getOwnPropertyNames;var Ht=Object.prototype.hasOwnProperty;var Ut=(e,t)=>{for(var s in t)et(e,s,{get:t[s],enumerable:!0})},Xt=(e,t,s,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Kt(t))!Ht.call(e,n)&&n!==s&&et(e,n,{get:()=>t[n],enumerable:!(i=Wt(t,n))||i.enumerable});return e};var Bt=e=>Xt(et({},"__esModule",{value:!0}),e);var ve={};Ut(ve,{copyOTP:()=>V,copyPassword:()=>X,default:()=>wt,pasteOTP:()=>z,pastePassword:()=>B});module.exports=Bt(ve);var h=require("@raycast/api"),D=require("react");var bt=require("os"),xt=require("child_process");var Mt=require("url"),Vt=e=>e[0].toUpperCase().concat(e.slice(1)),Pt=e=>e==="url"?e.toUpperCase():Vt(e),F=e=>e.endsWith("/"),St=e=>e.sort((t,s)=>F(t)&&!F(s)?-1:0),_t=e=>{try{return/^http[s]?:/.test(new Mt.URL(e).protocol)}catch{return!1}};function j(e){return new Promise((t,s)=>{let i=(0,xt.spawn)("gopass",e,{env:{HOME:(0,bt.homedir)(),PATH:["/bin","/usr/bin","/usr/local/bin","/usr/local/MacGPG2/bin","/opt/homebrew/bin"].join(":")}});i.on("error",s);let n=[];i.stderr.on("data",o=>n.push(o)),i.stderr.on("end",()=>n.length>0&&s(n.join("")));let r=[];i.stdout.on("data",o=>r.push(o)),i.stdout.on("end",()=>t(r.join("")))})}async function zt({limit:e=-1,prefix:t="",directoriesFirst:s=!1,stripPrefix:i=!1}={}){return await j(["list",`--limit=${e}`,"--flat",`--strip-prefix=${i}`,t]).then(n=>n.split(`
`)).then(n=>n.filter(r=>r.length)).then(n=>s?St(n):n)}async function Gt(e){return j(["show","--password",e])}async function Yt(e){return j(["otp","--password",e])}async function Jt(e){await j(["show","--clip",e])}async function Qt(e){return await j(["show",e]).then(t=>t.split(`
`).slice(1)).then(t=>t.filter(s=>s.includes(":")))}var T={list:zt,password:Gt,clip:Jt,show:Qt,otp:Yt};var p=require("@raycast/api"),W=require("react");var y=require("react/jsx-runtime");async function Zt(e,t){await p.Clipboard.copy(t),await(0,p.closeMainWindow)(),await(0,p.showHUD)(`${e} copied`)}async function qt(e,t){await(0,p.showHUD)(`${e} pasted`),await p.Clipboard.paste(t),await(0,p.closeMainWindow)()}function Et({entry:e}){let[t,s]=(0,W.useState)([]),[i,n]=(0,W.useState)(!0);return(0,W.useEffect)(()=>{T.show(e).then(s).catch(async r=>{console.error(r),await(0,p.showToast)({title:"Could not load passwords",style:p.Toast.Style.Failure})}).finally(()=>n(!1))},[]),(0,y.jsx)(p.List,{isLoading:i,children:(0,y.jsxs)(p.List.Section,{title:"/"+e,children:[!i&&(0,y.jsx)(p.List.Item,{title:"Password",subtitle:"*****************",actions:(0,y.jsxs)(p.ActionPanel,{children:[(0,y.jsx)(p.Action,{title:"Copy to Clipboard",icon:p.Icon.Clipboard,onAction:()=>X(e)}),(0,y.jsx)(p.Action,{title:"Paste to Active App",icon:p.Icon.Document,onAction:()=>B(e)})]})}),t.filter(r=>r.startsWith("otpauth:")).map((r,o)=>(0,y.jsx)(p.List.Item,{title:"OTP code",subtitle:"XXXXXX",actions:(0,y.jsxs)(p.ActionPanel,{children:[(0,y.jsx)(p.Action,{title:"Copy to Clipboard",icon:p.Icon.Clipboard,onAction:()=>V(e)}),(0,y.jsx)(p.Action,{title:"Paste to Active App",icon:p.Icon.Document,onAction:()=>z(e)})]})},o)),t.filter(r=>!r.startsWith("otpauth:")).map((r,o)=>{let[c,...a]=r.split(": "),l=a.join(": ");return(0,y.jsx)(p.List.Item,{title:Pt(c),subtitle:l,actions:(0,y.jsxs)(p.ActionPanel,{children:[_t(l)&&(0,y.jsx)(p.Action.OpenInBrowser,{url:l}),(0,y.jsx)(p.Action,{title:"Copy to Clipboard",icon:p.Icon.Clipboard,onAction:()=>Zt(c,l)}),(0,y.jsx)(p.Action,{title:"Paste to Active App",icon:p.Icon.Document,onAction:()=>qt(c,l)})]})},o)})]})})}function I(e){return Array.isArray?Array.isArray(e):vt(e)==="[object Array]"}var te=1/0;function ee(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-te?"-0":t}function se(e){return e==null?"":ee(e)}function b(e){return typeof e=="string"}function Rt(e){return typeof e=="number"}function ie(e){return e===!0||e===!1||ne(e)&&vt(e)=="[object Boolean]"}function kt(e){return typeof e=="object"}function ne(e){return kt(e)&&e!==null}function M(e){return e!=null}function st(e){return!e.trim().length}function vt(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var re="Incorrect 'index' type",oe=e=>`Invalid value for key ${e}`,ce=e=>`Pattern length exceeds max of ${e}.`,ae=e=>`Missing ${e} property in key`,le=e=>`Property 'weight' in key '${e}' must be a positive integer`,It=Object.prototype.hasOwnProperty,it=class{constructor(t){this._keys=[],this._keyMap={};let s=0;t.forEach(i=>{let n=$t(i);this._keys.push(n),this._keyMap[n.id]=n,s+=n.weight}),this._keys.forEach(i=>{i.weight/=s})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function $t(e){let t=null,s=null,i=null,n=1,r=null;if(b(e)||I(e))i=e,t=Ct(e),s=nt(e);else{if(!It.call(e,"name"))throw new Error(ae("name"));let o=e.name;if(i=o,It.call(e,"weight")&&(n=e.weight,n<=0))throw new Error(le(o));t=Ct(o),s=nt(o),r=e.getFn}return{path:t,id:s,weight:n,src:i,getFn:r}}function Ct(e){return I(e)?e:e.split(".")}function nt(e){return I(e)?e.join("."):e}function he(e,t){let s=[],i=!1,n=(r,o,c)=>{if(M(r))if(!o[c])s.push(r);else{let a=o[c],l=r[a];if(!M(l))return;if(c===o.length-1&&(b(l)||Rt(l)||ie(l)))s.push(se(l));else if(I(l)){i=!0;for(let u=0,f=l.length;u<f;u+=1)n(l[u],o,c+1)}else o.length&&n(l,o,c+1)}};return n(e,b(t)?t.split("."):t,0),i?s:s[0]}var ue={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},de={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},fe={location:0,threshold:.6,distance:100},pe={useExtendedSearch:!1,getFn:he,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},d={...de,...ue,...fe,...pe},ge=/[^ ]+/g;function me(e=1,t=3){let s=new Map,i=Math.pow(10,t);return{get(n){let r=n.match(ge).length;if(s.has(r))return s.get(r);let o=1/Math.pow(r,.5*e),c=parseFloat(Math.round(o*i)/i);return s.set(r,c),c},clear(){s.clear()}}}var K=class{constructor({getFn:t=d.getFn,fieldNormWeight:s=d.fieldNormWeight}={}){this.norm=me(s,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((s,i)=>{this._keysMap[s.id]=i})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,b(this.docs[0])?this.docs.forEach((t,s)=>{this._addString(t,s)}):this.docs.forEach((t,s)=>{this._addObject(t,s)}),this.norm.clear())}add(t){let s=this.size();b(t)?this._addString(t,s):this._addObject(t,s)}removeAt(t){this.records.splice(t,1);for(let s=t,i=this.size();s<i;s+=1)this.records[s].i-=1}getValueForItemAtKeyId(t,s){return t[this._keysMap[s]]}size(){return this.records.length}_addString(t,s){if(!M(t)||st(t))return;let i={v:t,i:s,n:this.norm.get(t)};this.records.push(i)}_addObject(t,s){let i={i:s,$:{}};this.keys.forEach((n,r)=>{let o=n.getFn?n.getFn(t):this.getFn(t,n.path);if(M(o)){if(I(o)){let c=[],a=[{nestedArrIndex:-1,value:o}];for(;a.length;){let{nestedArrIndex:l,value:u}=a.pop();if(M(u))if(b(u)&&!st(u)){let f={v:u,i:l,n:this.norm.get(u)};c.push(f)}else I(u)&&u.forEach((f,g)=>{a.push({nestedArrIndex:g,value:f})})}i.$[r]=c}else if(b(o)&&!st(o)){let c={v:o,n:this.norm.get(o)};i.$[r]=c}}}),this.records.push(i)}toJSON(){return{keys:this.keys,records:this.records}}};function Nt(e,t,{getFn:s=d.getFn,fieldNormWeight:i=d.fieldNormWeight}={}){let n=new K({getFn:s,fieldNormWeight:i});return n.setKeys(e.map($t)),n.setSources(t),n.create(),n}function we(e,{getFn:t=d.getFn,fieldNormWeight:s=d.fieldNormWeight}={}){let{keys:i,records:n}=e,r=new K({getFn:t,fieldNormWeight:s});return r.setKeys(i),r.setIndexRecords(n),r}function G(e,{errors:t=0,currentLocation:s=0,expectedLocation:i=0,distance:n=d.distance,ignoreLocation:r=d.ignoreLocation}={}){let o=t/e.length;if(r)return o;let c=Math.abs(i-s);return n?o+c/n:c?1:o}function ye(e=[],t=d.minMatchCharLength){let s=[],i=-1,n=-1,r=0;for(let o=e.length;r<o;r+=1){let c=e[r];c&&i===-1?i=r:!c&&i!==-1&&(n=r-1,n-i+1>=t&&s.push([i,n]),i=-1)}return e[r-1]&&r-i>=t&&s.push([i,r-1]),s}var v=32;function Ae(e,t,s,{location:i=d.location,distance:n=d.distance,threshold:r=d.threshold,findAllMatches:o=d.findAllMatches,minMatchCharLength:c=d.minMatchCharLength,includeMatches:a=d.includeMatches,ignoreLocation:l=d.ignoreLocation}={}){if(t.length>v)throw new Error(ce(v));let u=t.length,f=e.length,g=Math.max(0,Math.min(i,f)),m=r,w=g,P=c>1||a,R=P?Array(f):[],E;for(;(E=e.indexOf(t,w))>-1;){let S=G(t,{currentLocation:E,expectedLocation:g,distance:n,ignoreLocation:l});if(m=Math.min(S,m),w=E+u,P){let L=0;for(;L<u;)R[E+L]=1,L+=1}}w=-1;let $=[],k=1,H=u+f,jt=1<<u-1;for(let S=0;S<u;S+=1){let L=0,O=H;for(;L<O;)G(t,{errors:S,currentLocation:g+O,expectedLocation:g,distance:n,ignoreLocation:l})<=m?L=O:H=O,O=Math.floor((H-L)/2+L);H=O;let yt=Math.max(1,g-O+1),tt=o?f:Math.min(g+O,f)+u,N=Array(tt+2);N[tt+1]=(1<<S)-1;for(let _=tt;_>=yt;_-=1){let U=_-1,At=s[e.charAt(U)];if(P&&(R[U]=+!!At),N[_]=(N[_+1]<<1|1)&At,S&&(N[_]|=($[_+1]|$[_])<<1|1|$[_+1]),N[_]&jt&&(k=G(t,{errors:S,currentLocation:U,expectedLocation:g,distance:n,ignoreLocation:l}),k<=m)){if(m=k,w=U,w<=g)break;yt=Math.max(1,2*g-w)}}if(G(t,{errors:S+1,currentLocation:g,expectedLocation:g,distance:n,ignoreLocation:l})>m)break;$=N}let q={isMatch:w>=0,score:Math.max(.001,k)};if(P){let S=ye(R,c);S.length?a&&(q.indices=S):q.isMatch=!1}return q}function Me(e){let t={};for(let s=0,i=e.length;s<i;s+=1){let n=e.charAt(s);t[n]=(t[n]||0)|1<<i-s-1}return t}var Y=class{constructor(t,{location:s=d.location,threshold:i=d.threshold,distance:n=d.distance,includeMatches:r=d.includeMatches,findAllMatches:o=d.findAllMatches,minMatchCharLength:c=d.minMatchCharLength,isCaseSensitive:a=d.isCaseSensitive,ignoreLocation:l=d.ignoreLocation}={}){if(this.options={location:s,threshold:i,distance:n,includeMatches:r,findAllMatches:o,minMatchCharLength:c,isCaseSensitive:a,ignoreLocation:l},this.pattern=a?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;let u=(g,m)=>{this.chunks.push({pattern:g,alphabet:Me(g),startIndex:m})},f=this.pattern.length;if(f>v){let g=0,m=f%v,w=f-m;for(;g<w;)u(this.pattern.substr(g,v),g),g+=v;if(m){let P=f-v;u(this.pattern.substr(P),P)}}else u(this.pattern,0)}searchIn(t){let{isCaseSensitive:s,includeMatches:i}=this.options;if(s||(t=t.toLowerCase()),this.pattern===t){let w={isMatch:!0,score:0};return i&&(w.indices=[[0,t.length-1]]),w}let{location:n,distance:r,threshold:o,findAllMatches:c,minMatchCharLength:a,ignoreLocation:l}=this.options,u=[],f=0,g=!1;this.chunks.forEach(({pattern:w,alphabet:P,startIndex:R})=>{let{isMatch:E,score:$,indices:k}=Ae(t,w,P,{location:n+R,distance:r,threshold:o,findAllMatches:c,minMatchCharLength:a,includeMatches:i,ignoreLocation:l});E&&(g=!0),f+=$,E&&k&&(u=[...u,...k])});let m={isMatch:g,score:g?f/this.chunks.length:1};return g&&i&&(m.indices=u),m}},x=class{constructor(t){this.pattern=t}static isMultiMatch(t){return Lt(t,this.multiRegex)}static isSingleMatch(t){return Lt(t,this.singleRegex)}search(){}};function Lt(e,t){let s=e.match(t);return s?s[1]:null}var rt=class extends x{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){let s=t===this.pattern;return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}},ot=class extends x{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){let i=t.indexOf(this.pattern)===-1;return{isMatch:i,score:i?0:1,indices:[0,t.length-1]}}},ct=class extends x{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){let s=t.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}},at=class extends x{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){let s=!t.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,t.length-1]}}},lt=class extends x{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){let s=t.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[t.length-this.pattern.length,t.length-1]}}},ht=class extends x{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){let s=!t.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,t.length-1]}}},J=class extends x{constructor(t,{location:s=d.location,threshold:i=d.threshold,distance:n=d.distance,includeMatches:r=d.includeMatches,findAllMatches:o=d.findAllMatches,minMatchCharLength:c=d.minMatchCharLength,isCaseSensitive:a=d.isCaseSensitive,ignoreLocation:l=d.ignoreLocation}={}){super(t),this._bitapSearch=new Y(t,{location:s,threshold:i,distance:n,includeMatches:r,findAllMatches:o,minMatchCharLength:c,isCaseSensitive:a,ignoreLocation:l})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}},Q=class extends x{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let s=0,i,n=[],r=this.pattern.length;for(;(i=t.indexOf(this.pattern,s))>-1;)s=i+r,n.push([i,s-1]);let o=!!n.length;return{isMatch:o,score:o?0:1,indices:n}}},ut=[rt,Q,ct,at,ht,lt,ot,J],Ot=ut.length,Pe=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Se="|";function _e(e,t={}){return e.split(Se).map(s=>{let i=s.trim().split(Pe).filter(r=>r&&!!r.trim()),n=[];for(let r=0,o=i.length;r<o;r+=1){let c=i[r],a=!1,l=-1;for(;!a&&++l<Ot;){let u=ut[l],f=u.isMultiMatch(c);f&&(n.push(new u(f,t)),a=!0)}if(!a)for(l=-1;++l<Ot;){let u=ut[l],f=u.isSingleMatch(c);if(f){n.push(new u(f,t));break}}}return n})}var be=new Set([J.type,Q.type]),dt=class{constructor(t,{isCaseSensitive:s=d.isCaseSensitive,includeMatches:i=d.includeMatches,minMatchCharLength:n=d.minMatchCharLength,ignoreLocation:r=d.ignoreLocation,findAllMatches:o=d.findAllMatches,location:c=d.location,threshold:a=d.threshold,distance:l=d.distance}={}){this.query=null,this.options={isCaseSensitive:s,includeMatches:i,minMatchCharLength:n,findAllMatches:o,ignoreLocation:r,location:c,threshold:a,distance:l},this.pattern=s?t:t.toLowerCase(),this.query=_e(this.pattern,this.options)}static condition(t,s){return s.useExtendedSearch}searchIn(t){let s=this.query;if(!s)return{isMatch:!1,score:1};let{includeMatches:i,isCaseSensitive:n}=this.options;t=n?t:t.toLowerCase();let r=0,o=[],c=0;for(let a=0,l=s.length;a<l;a+=1){let u=s[a];o.length=0,r=0;for(let f=0,g=u.length;f<g;f+=1){let m=u[f],{isMatch:w,indices:P,score:R}=m.search(t);if(w){if(r+=1,c+=R,i){let E=m.constructor.type;be.has(E)?o=[...o,...P]:o.push(P)}}else{c=0,r=0,o.length=0;break}}if(r){let f={isMatch:!0,score:c/r};return i&&(f.indices=o),f}}return{isMatch:!1,score:1}}},ft=[];function xe(...e){ft.push(...e)}function pt(e,t){for(let s=0,i=ft.length;s<i;s+=1){let n=ft[s];if(n.condition(e,t))return new n(e,t)}return new Y(e,t)}var Z={AND:"$and",OR:"$or"},gt={PATH:"$path",PATTERN:"$val"},mt=e=>!!(e[Z.AND]||e[Z.OR]),Ee=e=>!!e[gt.PATH],Ie=e=>!I(e)&&kt(e)&&!mt(e),Tt=e=>({[Z.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function Ft(e,t,{auto:s=!0}={}){let i=n=>{let r=Object.keys(n),o=Ee(n);if(!o&&r.length>1&&!mt(n))return i(Tt(n));if(Ie(n)){let a=o?n[gt.PATH]:r[0],l=o?n[gt.PATTERN]:n[a];if(!b(l))throw new Error(oe(a));let u={keyId:nt(a),pattern:l};return s&&(u.searcher=pt(l,t)),u}let c={children:[],operator:r[0]};return r.forEach(a=>{let l=n[a];I(l)&&l.forEach(u=>{c.children.push(i(u))})}),c};return mt(e)||(e=Tt(e)),i(e)}function Ce(e,{ignoreFieldNorm:t=d.ignoreFieldNorm}){e.forEach(s=>{let i=1;s.matches.forEach(({key:n,norm:r,score:o})=>{let c=n?n.weight:null;i*=Math.pow(o===0&&c?Number.EPSILON:o,(c||1)*(t?1:r))}),s.score=i})}function Le(e,t){let s=e.matches;t.matches=[],M(s)&&s.forEach(i=>{if(!M(i.indices)||!i.indices.length)return;let{indices:n,value:r}=i,o={indices:n,value:r};i.key&&(o.key=i.key.src),i.idx>-1&&(o.refIndex=i.idx),t.matches.push(o)})}function Oe(e,t){t.score=e.score}function Te(e,t,{includeMatches:s=d.includeMatches,includeScore:i=d.includeScore}={}){let n=[];return s&&n.push(Le),i&&n.push(Oe),e.map(r=>{let{idx:o}=r,c={item:t[o],refIndex:o};return n.length&&n.forEach(a=>{a(r,c)}),c})}var C=class{constructor(t,s={},i){this.options={...d,...s},this.options.useExtendedSearch,this._keyStore=new it(this.options.keys),this.setCollection(t,i)}setCollection(t,s){if(this._docs=t,s&&!(s instanceof K))throw new Error(re);this._myIndex=s||Nt(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){M(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){let s=[];for(let i=0,n=this._docs.length;i<n;i+=1){let r=this._docs[i];t(r,i)&&(this.removeAt(i),i-=1,n-=1,s.push(r))}return s}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:s=-1}={}){let{includeMatches:i,includeScore:n,shouldSort:r,sortFn:o,ignoreFieldNorm:c}=this.options,a=b(t)?b(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return Ce(a,{ignoreFieldNorm:c}),r&&a.sort(o),Rt(s)&&s>-1&&(a=a.slice(0,s)),Te(a,this._docs,{includeMatches:i,includeScore:n})}_searchStringList(t){let s=pt(t,this.options),{records:i}=this._myIndex,n=[];return i.forEach(({v:r,i:o,n:c})=>{if(!M(r))return;let{isMatch:a,score:l,indices:u}=s.searchIn(r);a&&n.push({item:r,idx:o,matches:[{score:l,value:r,norm:c,indices:u}]})}),n}_searchLogical(t){let s=Ft(t,this.options),i=(c,a,l)=>{if(!c.children){let{keyId:f,searcher:g}=c,m=this._findMatches({key:this._keyStore.get(f),value:this._myIndex.getValueForItemAtKeyId(a,f),searcher:g});return m&&m.length?[{idx:l,item:a,matches:m}]:[]}let u=[];for(let f=0,g=c.children.length;f<g;f+=1){let m=c.children[f],w=i(m,a,l);if(w.length)u.push(...w);else if(c.operator===Z.AND)return[]}return u},n=this._myIndex.records,r={},o=[];return n.forEach(({$:c,i:a})=>{if(M(c)){let l=i(s,c,a);l.length&&(r[a]||(r[a]={idx:a,item:c,matches:[]},o.push(r[a])),l.forEach(({matches:u})=>{r[a].matches.push(...u)}))}}),o}_searchObjectList(t){let s=pt(t,this.options),{keys:i,records:n}=this._myIndex,r=[];return n.forEach(({$:o,i:c})=>{if(!M(o))return;let a=[];i.forEach((l,u)=>{a.push(...this._findMatches({key:l,value:o[u],searcher:s}))}),a.length&&r.push({idx:c,item:o,matches:a})}),r}_findMatches({key:t,value:s,searcher:i}){if(!M(s))return[];let n=[];if(I(s))s.forEach(({v:r,i:o,n:c})=>{if(!M(r))return;let{isMatch:a,score:l,indices:u}=i.searchIn(r);a&&n.push({score:l,key:t,value:r,idx:o,norm:c,indices:u})});else{let{v:r,n:o}=s,{isMatch:c,score:a,indices:l}=i.searchIn(r);c&&n.push({score:a,key:t,value:r,norm:o,indices:l})}return n}};C.version="7.0.0";C.createIndex=Nt;C.parseIndex=we;C.config=d;C.parseQuery=Ft;xe(dt);var A=require("react/jsx-runtime");async function X(e){try{let t=await(0,h.showToast)({title:"Copying password",style:h.Toast.Style.Animated});await T.clip(e),await t.hide(),await(0,h.closeMainWindow)(),await(0,h.showHUD)("Password copied")}catch(t){console.error(t),await(0,h.showToast)({title:"Could not copy password",style:h.Toast.Style.Failure})}}async function B(e){try{let t=await(0,h.showToast)({title:"Pasting password",style:h.Toast.Style.Animated}),s=await T.password(e);await h.Clipboard.paste(s),await t.hide(),await(0,h.closeMainWindow)(),await(0,h.showHUD)("Password pasted")}catch(t){console.error(t),await(0,h.showToast)({title:"Could not paste password",style:h.Toast.Style.Failure})}}async function V(e){try{let t=await(0,h.showToast)({title:"Copying OTP",style:h.Toast.Style.Animated}),s=await T.otp(e);await h.Clipboard.copy(s),await t.hide(),await(0,h.closeMainWindow)(),await(0,h.showHUD)("OTP copied")}catch(t){console.error(t),await(0,h.showToast)({title:"Could not copy OTP code",style:h.Toast.Style.Failure})}}async function z(e){try{let t=await(0,h.showToast)({title:"Pasting OTP",style:h.Toast.Style.Animated}),s=await T.otp(e);await h.Clipboard.paste(s),await t.hide(),await(0,h.closeMainWindow)(),await(0,h.showHUD)("OTP pasted")}catch(t){console.error(t),await(0,h.showToast)({title:"Could not paste OTP code",style:h.Toast.Style.Failure})}}var Re=e=>(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(h.Action,{title:"Copy Password to Clipboard",icon:h.Icon.Clipboard,onAction:()=>X(e)}),(0,A.jsx)(h.Action,{title:"Paste Password to Active App",icon:h.Icon.Document,onAction:()=>B(e),shortcut:{modifiers:["cmd","shift"],key:"enter"}}),(0,A.jsx)(h.Action,{title:"Copy OTP Code to Clipboard",icon:h.Icon.Clipboard,onAction:()=>V(e),shortcut:{modifiers:["cmd"],key:"o"}}),(0,A.jsx)(h.Action,{title:"Paste OTP Code to Active App",icon:h.Icon.Document,onAction:()=>z(e),shortcut:{modifiers:["cmd","shift"],key:"o"}})]}),Dt=e=>F(e)?h.Icon.Folder:h.Icon.Key,ke=e=>F(e)?(0,A.jsx)(wt,{prefix:e}):(0,A.jsx)(Et,{entry:e});function wt({prefix:e=""}){let[t,s]=(0,D.useState)([]),[i,n]=(0,D.useState)(!0),[r,o]=(0,D.useState)("");return(0,D.useEffect)(()=>{T.list({limit:r?-1:0,prefix:e,directoriesFirst:!0,stripPrefix:!0}).then(c=>new C(c,{useExtendedSearch:!0,keys:["item"]}).search(r).map(a=>a.item)).then(s).catch(async c=>{console.error(c),await(0,h.showToast)({title:"Could not load passwords",style:h.Toast.Style.Failure})}).finally(()=>n(!1))},[r]),(0,A.jsx)(h.List,{isLoading:i,enableFiltering:!1,onSearchTextChange:o,children:(0,A.jsx)(h.List.Section,{title:r?"Results":"/"+e,subtitle:r&&String(t.length),children:t.map((c,a)=>{let l=e+c;return(0,A.jsx)(h.List.Item,{title:c,icon:Dt(c),accessories:[{icon:h.Icon.ChevronRight}],actions:(0,A.jsxs)(h.ActionPanel,{children:[(0,A.jsx)(h.Action.Push,{title:"Show Details",icon:Dt(c),target:ke(l)}),!F(c)&&Re(l)]})},a)})})})}0&&(module.exports={copyOTP,copyPassword,pasteOTP,pastePassword});
